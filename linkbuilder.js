'use strict'

const linkData = [
    {
        title: "New Sprint",
        links: [
            { text: "Leveransgrad vs resursdagar", url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/New Sprint - Leveransgrad vs resursdagar.htm", class: "button1" },
            { text: "Leveransgrad (US - Bug) senaste sprintar", url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/New Sprint - Leveransgrad (US - Bug) 10 resp 5 sprintar.htm", class: "button1" },
            { text: "Leveransgrad (US) - antal vs h", url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/New Sprint Leveransgrad antal vs h.htm", class: "button1" },
            { text: "Senaste sprint", url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/New Sprint - Leverans.htm", class: "button1" }
        ],
        subgroups: [
            {
                title: " ",
                links: [
                    { text: "RoadMap",                      url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/RoadMap.htm", class: "button2" },
                    { text: "RoadMap - Due Dates",          url: "file://id-infra02/Home/jgn/My%20Documents/IDATA/_Publish/RoadMap%20Due%20Dates.htm", class: "button2" },
                    { text: "Resursberäkning (RoadMap)",    url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/Resursredovisning-(RoadMap).htm", class: "button1" }
                ]
            },
            {
                title: " ",
                links: [
                    { text: "RoadMapGenomsnittstid för US i Product backlog", url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/US genomsnittstid i status Product Backlog.htm')", class: "buttonTemp" }
                ]
            }
        ]
    },
    {
        title: "Time line",
        links: [
            { text: "Beslutade US",                         url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/Time line - US - Alla beslutade US.htm", class: "button1" },
            { text: "Krav som ej ännu produktionssatta",    url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/Time line - US - Krav som ej produktionssatta.htm", class: "button2" }
        ],
    
        subgroups: [
            {
                title: "Sprintplanering",
                links: [
                    { text: "ToDo - Sprintplanering",               url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/58949678/Sprintplaneringen", class: "button2" },
                    { text: "Backloggnedbrytningar",                url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/310476810/Sprintnedbrytningar", class: "button1" },
                    { text: "Antal sprintar beslutade US ingått",   url: "file://id-infra02/Home/jgn/My%20Documents/IDATA/_Publish/Time%20line%20-%20US%20-%20Antal%20sprintar%20ing%C3%A5tt.htm", class: "button1" },
                    { text: "Prio från WS",                         url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/New Sprint - Prio från ws.htm", class: "button2" },
                    { text: "Min Reminders",                        url: "file://///id-infra02/Home/jgn/My Documents/IDATA/PO/Publish/Minreminders.htm", class: "button1" },
                    { text: "Deadlines",                            url: "https://idataab.atlassian.net/wiki/spaces/PROD/pages/158728193/Deadlines", class: "button1" }
                ]
            },
            {
                title: " ",
                links: [
                    { text: "Affärsutveckling",                     url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/323551244/Logg", class: "button1" },
                    { text: "Avstämning MKM",                       url: "file://///id-infra02/Home/jgn/My Documents/IDATA/PO/Underlag MKM/Avstämning MKM.htm", class: "button1" }
                ]
            }
        ]
    },
    {
        title: "Flöden",
        links: [
            { text: "IDATA - Tjänster",         url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/339771393/IDATA+-+Tj+nster", class: "button1" },
            { text: "Publikt-API (koncept)",    url: "file://id-infra02/Home/jgn/My%20Documents/IDATA/_Publish/Publikt-API.htm", class: "button1" },
            { text: "Rollhantering",            url: "file://id-infra02/Home/jgn/My%20Documents/IDATA/_Publish/rollhantering.htm", class: "button1" },
            { text: "Olika referenstyper",      url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/262897685/Olika+referenser", class: "button2" },
            { text: "eInlaga-eBilaga-Inlagor",  url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/17795597/eInlaga-eBilaga-Inlagor", class: "button1" },
            { text: "Utökad lagring - Arkiv",   url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/17795708/Ut+kadlagring", class: "button2" },
            { text: "Sekretess-Engångsutskick", url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/220823555/Sekretessutskick+vs+Eng+ngsutskick", class: "button1" },
            { text: "REK - internhantering",    url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/346128387/REK+-+manuell+rutin", class: "button1" }
        ],
        
        subgroups: [
            {               
                title: " ",
                links: [
                    { text: "Kort guide - Ställ en fråga (Jira)",                       url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/Kort guide för att arbeta med Ställ en fråga.htm", class: "button2" },
                    { text: "REK - Kivra (Pages.Jörgen)",                               url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/255230217/Hantera+REK+-+Kivra", class: "button1" },
                    { text: "Dokumentstatus (API) & EbeställningMatchC (Pages.Jörgen)", url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/354189355/Publik+Status+f+r+dokument+via+API", class: "button1" },
                    { text: "Quadient",                                                 url: "https://idataab.atlassian.net/wiki/spaces/JOR/pages/308609041/Quadient", class: "button1" },
                    { text: "OmniGo Timeplan",                                          url: "file://///id-infra02/Home/jgn/My Documents/IDATA/_Publish/Timeline OmniGo migrated (Tidsplan).htm", class: "button1" }
                ]          
            }
        ]
    },
    {
        title: "Public",
        links: [
            { text: "Sprintdemo(n)",    url: "https://idataab.atlassian.net/wiki/spaces/SCRUM/pages/17237019/Sprintar", class: "button1" },
            { text: "Release demo(n)",  url: "https://idataab.atlassian.net/wiki/spaces/PROD/pages/89260119/Releasedemo", class: "button1" },
            { text: "Kontorspost [DB]", url: "https://idataab.atlassian.net/wiki/spaces/PROD/database/444694531?atl_f=PAGETREE", class: "button2" }
        ],
        
        subgroups: [
            {               
                title: " ",
                links: [
                    { text: "FINQR",                        url: "https://idataab.atlassian.net/wiki/spaces/PROD/pages/279315249/FINQR", class: "button1" },
                    { text: "Quadient [DB]",                url: "https://idataab.atlassian.net/wiki/spaces/PROD/database/381124616?atl_f=PAGETREE&savedViewId=594c0e42-4be7-47e2-b4fa-6099b1fb39d6", class: "button1" },
                    { text: "Kivra - REK digitalabrev",     url: "https://idataab.atlassian.net/wiki/spaces/PROD/pages/255133382/REK Digitala brev - Kivra", class: "button1" },
                    { text: "Bisnis Analys Sverige",        url: "https://idataab.atlassian.net/wiki/spaces/PROD/pages/351436854/Bisnis Analys Sverige", class: "button2" }
                ]
            },
            {               
                title: " ",
                links: [
                    { text: "Konceptuell beskrivning av TRF",       url: "https://idataab.atlassian.net/wiki/spaces/PROD/pages/251396098/Konceptuell+beskrivning+av+TRF", class: "button2" },
                    { text: "Kontorspost - ej ursprungs scope",     url: "https://idataab.atlassian.net/issues/?filter=10736", class: "button2" },
                    { text: "Statuskedja för API-dokument",         url: "https://idataab.atlassian.net/wiki/spaces/PROD/pages/354549912/Statuskedja+f+r+dokument+via+publika+API", class: "button2" },
                    { text: "IDATA Public API (doc)",               url: "https://developer.idata.se/", class: "button2" }
                ]
            }
        ]
    }
];



function renderLinks() {
    const container = document.getElementById("linkContainer");
    container.innerHTML = ""; // rensa

    createToggleButtons(linkData);   // skapa topp-knapparna

    linkData.forEach((section, secIndex) => {
        const col = document.createElement("div");
        col.className = "column";
         col.id = "section_" + secIndex; // <-- viktiga ID:t för toggling

        // Huvudrubrik
        const header = document.createElement("h4");
        header.textContent = section.title;
        col.appendChild(header);

        // Länkar utan subgrupper
        renderLinkList(col, section.links);

        // Subgrupper (om finns)
        if (section.subgroups) {
            section.subgroups.forEach(sub => {
                if (sub.title) {
                    const subh = document.createElement("div");
                    subh.className = "subheader";
                    subh.textContent = sub.title;
                    col.appendChild(subh);
                }
                renderLinkList(col, sub.links);
            });
        }

        container.appendChild(col);
    });
}


function createToggleButtons(sections) {
    const toggleContainer = document.getElementById("sectionToggles");

    sections.forEach((sec, index) => {
        const btn = document.createElement("button");
        btn.textContent = sec.title;
        btn.classList.add("active");

        btn.addEventListener("click", () => {
            // hitta kolumnen
            const col = document.getElementById("section_" + index);

            // toggla synlighet
            const nowHidden = col.style.display === "none";
            col.style.display = nowHidden ? "block" : "none";

            // toggla färg
            btn.classList.toggle("active", nowHidden);
        });

        toggleContainer.appendChild(btn);
    });
}



function renderLinkList(parent, links) {
    links.forEach(link => {
        const a = document.createElement("a");
        link.url.substring(0, 5) == 'https' ?  a.href = "javascript:window.open('" + link.url + "')" : a.href = link.url;

        const btn = document.createElement("button");
        btn.className = "button " + link.class;
        btn.textContent = link.text;

        a.appendChild(btn);
        parent.appendChild(a);
    });
}

/*
function getLink() {
    if (window.location.protocol === 'file:') {
        return 1==1; //"javascript:window.open('file://///";
    } else {
        return 1==0; //"file://///";
    }
}
*/
renderLinks();